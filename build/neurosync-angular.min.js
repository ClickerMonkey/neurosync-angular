!function(e,t,o){function n(e){Neuro.rest=function(t){function n(t,o,n,r,i,s){function u(e){r(e.data)}function a(e){i(e.data,e.status)}if(Neuro.debug(Neuro.Debugs.REST,this,t,n,o),Neuro.forceOffline)i(s,0);else{var c={method:t,data:o,url:n};e(c).then(u,a)}}return{all:function(e,r){n("GET",o,t.api,e,r,[])},get:function(e,r,i){n("GET",o,t.api+e.$key(),r,i)},create:function(e,o,r,i){n("POST",o,t.api,r,i,{})},update:function(e,o,r,i){n("PUT",o,t.api+e.$key(),r,i,{})},remove:function(e,r,i){n("DELETE",o,t.api+e.$key(),r,i,{})},query:function(e,t,r){var i=e.method||"GET",s=e.data||o,u=e.url||e;n(i,s,u,t,r)}}};var t=Neuro.debug;return Neuro.debug=function(){d.debug&&t.apply(this,arguments)},Neuro.Debugs.ScopeEval=1e5,Neuro.listenToNetworkStatus(),Neuro}function r(){return s}function i(){return u}function s(e,t,o){return this instanceof s?(this.scope=e,this.target=t,this.callback=o,this.notify=this.newNotification(),this.release=this.newRelease(),void this.on()):new s(e,t,o)}function u(e,t,o){this.$onRemove=Neuro.copyFunction(this.$handleRemove),this.$onRemoves=Neuro.copyFunction(this.$handleRemoves),this.$onCleared=Neuro.copyFunction(this.$handleCleared),this.$onReset=Neuro.copyFunction(this.$handleReset),this.$reset(e),this.$select(t,o)}function a(e,t){return e.replace($,function(e,o){return o in t?t[o]:""})}function c(e){if(e in c.tested)return c.tested[e];try{return angular.module(e),c.tested[e]=!0}catch(t){return c.tested[e]=!1}}function f(){return f.cached?f.cached:f.cached=c("ui.router")?"$stateParams":c("ngRoute")?"$route":!1}function h(){return c("ui.router")?function(e){return e}:c("ngRoute")?function(e){return e.current}:function(){return!1}}function l(e){return function(t){return Neuro.isString(t)&&e?a(t,e):t}}var d={debug:!1},v={};e.constant("NeuroResolve",v).constant("NeuroSettings",d).factory("Neuro",["$http",n]).factory("NeuroBind",r).factory("NeuroSelect",i),t.NeuroBind=s,t.NeuroResolve=v,t.NeuroSelect=u,s.Events={Database:"updated",Model:"saved removed remote-update relation-update",Collection:"add adds sort remove reset",Page:"change",Scope:"$destroy"},s.prototype={on:function(){Neuro.isNeuro(this.target)&&(this.target=this.target.Database),this.target instanceof Neuro.Database?this.target.on(s.Events.Database,this.notify):this.target instanceof Neuro.Model?this.target.$on(s.Events.Model,this.notify):this.target instanceof Neuro.Collection?this.target.on(s.Events.Collection,this.notify):this.target instanceof Neuro.Page&&this.target.on(s.Events.Page,this.notify),this.scope.$on(s.Events.Scope,this.release)},off:function(){this.target instanceof Neuro.Database?this.target.off(s.Events.Database,this.notify):this.target instanceof Neuro.Model?this.target.$off(s.Events.Model,this.notify):this.target instanceof Neuro.Collection?this.target.off(s.Events.Collection,this.notify):this.target instanceof Neuro.Page&&this.target.off(s.Events.Page,this.notify)},newRelease:function(){var e=this;return function(){e.off()}},newNotification:function(){var e=this;return function(){e.scope.$evalAsync(function(){e.callback&&e.callback.apply(e.target),d.debug&&Neuro.debug("[Scope:$evalAsync]",e.scope)})}}},u.prototype={$reset:function(e){this.$source!==e&&(this.$source&&this.$disconnect(),this.$source=e,this.$connect())},$connect:function(){this.$source.on(Neuro.Collection.Events.Remove,this.$onRemove,this),this.$source.on(Neuro.Collection.Events.Removes,this.$onRemoves,this),this.$source.on(Neuro.Collection.Events.Cleared,this.$onCleared,this),this.$source.on(Neuro.Collection.Events.Reset,this.$onReset,this)},$disconnect:function(){this.$source.off(Neuro.Collection.Events.Remove,this.$onRemove),this.$source.off(Neuro.Collection.Events.Removes,this.$onRemoves),this.$source.off(Neuro.Collection.Events.Cleared,this.$onCleared),this.$source.off(Neuro.Collection.Events.Reset,this.$onReset)},$select:function(e,t){if(Neuro.isArray(e)){var o=this.$source.database,n={};for(var r in this)"boolean"==typeof this[r]&&(n[r]=this[r]);for(var i=0;i<e.length;i++){var r=o.buildKeyFromInput(e[i]);this[r]=!0,delete n[r]}for(var r in n)delete this[r];if(t)for(var s=this.$source.keys(),i=0;i<s.length;i++){var r=s[i];this[r]||(this[r]=!1)}}},$selection:function(e){var t=this.$source,o=e||[];for(var n in this)if(this[n]===!0){var r=t.get(n);r&&o.push(r)}return o},$handleRemove:function(e){var t=this.$source.database,o=t.buildKeyFromInput(e);delete this[o]},$handleRemoves:function(e){for(var t=0;t<e.length;t++)this.$handleRemove(e[t])},$handleCleared:function(){for(var e in this)"boolean"==typeof this[e]&&delete this[e]},$handleReset:function(){var e=this.$source;for(var t in this)"boolean"==typeof this[t]&&(e.has(t)||delete this[t])}},Neuro.ModelCollection.prototype.selectable=function(e,t){return new u(this,e,t)};var $=/\{([^\}]+)\}/;c.tested={},f.cached=null,v.factory=function(e,t){var o=f(),n=h(),r=["$q",function(o,r){var i=o.defer(),s=n(r),u=l(s);return Neuro.get(e,function(e){t(e,i,u)}),i.promise}];return o&&r.splice(1,0,o),r},v.model=function(e,t){return v.factory(e,function(e,o,n){e.Database.grabModel(n(t),function(e){e?o.resolve(e):o.reject()})})},v.fetch=function(e,t){return v.factory(e,function(e,o,n){o.resolve(e.fetch(n(t)))})},v.fetchAll=function(e){return v.factory(e,function(e,t,o){e.fetchAll(function(e){t.resolve(e)})})},v.create=function(e,t,o){return v.factory(e,function(e,n,r){o?n.resolve(new e(t)):n.resolve(e.create(t))})},v.query=function(e,t){return v.factory(e,function(e,o,n){var r=e.query(n(t));r.success(function(){o.resolve(r)}),r.failure(function(){o.reject()})})},v.all=function(e){return v.factory(e,function(e,t,o){e.Database.ready(function(){t.resolve(e.all())})})},v.where=function(e,t,o,n){return v.factory(e,function(e,r,i){if(Neuro.isObject(t))for(var s in t)t[s]=i(t[s]);Neuro.isString(o)&&(o=i(o)),e.Database.ready(function(){r.resolve(e.all().filtered(t,o,n))})})}}(angular.module("neurosync",[]),window);
//# sourceMappingURL=neurosync-angular.min.js.map
