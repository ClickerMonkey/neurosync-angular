!function(e,t,n,r,o){function i(e){r.setRest(function(t){function n(e){return"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}function i(t,n,o,i,s,c){function u(e){i(e.data)}function a(e){s(e.data,e.status)}if(r.debug(r.Debugs.REST,this,t,o,n),r.forceOffline)s(c,0);else{var f={method:t,data:n,url:o};e(f).then(u,a)}}return{all:function(e,n){i("GET",o,t.api,e,n,[])},get:function(e,r,s){i("GET",o,n(t.api+e.$key()),r,s)},create:function(e,r,o,s){i("POST",r,n(t.api),o,s,{})},update:function(e,r,o,s){i("PUT",r,n(t.api+e.$key()),o,s,{})},remove:function(e,r,s){i("DELETE",o,n(t.api+e.$key()),r,s,{})},query:function(e,t,n,r){var o=t?"POST":"GET";i(o,t,e,n,r)}}}),r.listenToNetworkStatus()}function s(e,t,n){return this instanceof s?(this.scope=e,this.target=t,this.callback=n,void this.on()):new s(e,t,n)}function c(e,t,n){this.$onRemove=r.bind(this,this.$handleRemove),this.$onRemoves=r.bind(this,this.$handleRemoves),this.$onCleared=r.bind(this,this.$handleCleared),this.$onReset=r.bind(this,this.$handleReset),this.$reset(e),this.$select(t,n)}function u(e){if(e in u.tested)return u.tested[e];try{return angular.module(e),u.tested[e]=!0}catch(t){return u.tested[e]=!1}}function a(){return a.cached?a.cached:a.cached=u("ui.router")?"$stateParams":u("ngRoute")?"$route":!1}function f(){return u("ui.router")?function(e){return e}:u("ngRoute")?function(e){return e.current}:function(){return!1}}function l(e){return function(t){return r.isString(t)&&e?r.format(t,e):t}}function h(e,t){if(r.isObject(e)){var n={};for(var o in e)n[o]=t(e[o]);return n}return t(e)}function v(){return function(e){if(!e||!e.toArray)return e;for(var t=e.toArray(),n={},r=0;r<t.length;r++){var o=t[r];!o.$key||o.$key()in n?t.splice(r--,1):n[o.$key()]=o}return t}}var d={},$={};n.isArray=function(e){return e instanceof Array},s.prototype={on:function(){var e=this.target;r.isRekord(e)&&(e=this.target=e.Database),this.off=e[e.$change?"$change":"change"](this.notify,this),this.scope.$on("$destroy",this.off)},notify:function(){var e=this.scope;e.$$phase||(e.$digest(),this.callback&&this.callback.apply(this.target),r.debug(r.Debugs.ScopeDigest,this,e))}},c.prototype={$reset:function(e){this.$source!==e&&(this.$source&&this.$disconnect(),this.$source=e,this.$connect())},$connect:function(){this.$source.on(r.Collection.Events.Remove,this.$onRemove),this.$source.on(r.Collection.Events.Removes,this.$onRemoves),this.$source.on(r.Collection.Events.Cleared,this.$onCleared),this.$source.on(r.Collection.Events.Reset,this.$onReset)},$disconnect:function(){this.$source.off(r.Collection.Events.Remove,this.$onRemove),this.$source.off(r.Collection.Events.Removes,this.$onRemoves),this.$source.off(r.Collection.Events.Cleared,this.$onCleared),this.$source.off(r.Collection.Events.Reset,this.$onReset)},$select:function(e,t){if(r.isArray(e)){var n=this.$source.database,o={};for(var i in this)r.isBoolean(this[i])&&(o[i]=this[i]);for(var s=0;s<e.length;s++){var i=n.buildKeyFromInput(e[s]);this[i]=!0,delete o[i]}for(var i in o)delete this[i];if(t)for(var c=this.$source.keys(),s=0;s<c.length;s++){var i=c[s];this[i]||(this[i]=!1)}}},$selection:function(e){var t=this.$source,n=e||[];for(var r in this)if(this[r]===!0){var o=t.get(r);o&&n.push(o)}return n},$handleRemove:function(e){var t=this.$source.database,n=t.buildKeyFromInput(e);delete this[n]},$handleRemoves:function(e){for(var t=0;t<e.length;t++)this.$handleRemove(e[t])},$handleCleared:function(){for(var e in this)r.isBoolean(this[e])&&delete this[e]},$handleReset:function(){var e=this.$source;for(var t in this)r.isBoolean(this[t])&&(e.has(t)||delete this[t])}},r.ModelCollection.prototype.selectable=function(e,t){return new c(this,e,t)},u.tested={},a.cached=null,d.factory=function(e,t){function n(n,o){var u=n.defer();if(void 0!==c)u.resolve(c);else{var a=i(o),f=l(a);s&&u.promise.then(function(e){c=e}),r.get(e).success(function(e){t(e,u,f)})}return u.promise}var o=a(),i=f(),s=!1,c=void 0;return n.$inject=["$q"],o&&n.$inject.push(o),n.cache=function(){return s=!0,n},n.inject=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];r.isArray(t)?n.$inject.push.apply(n.$inject,t):n.$inject.push(t)}return n},n},d.model=function(e,t){return d.factory(e,function(e,n,r){var o=h(t,r);e.Database.grabModel(o,function(e){e?n.resolve(e):n.reject()})})},d.fetch=function(e,t){return d.factory(e,function(e,n,r){var o=h(t,r);e.fetch(o,function(e){n.resolve(e)})})},d.fetchAll=function(e){return d.factory(e,function(e,t,n){e.fetchAll(function(e){t.resolve(e)})})},d.grab=function(e,t){return d.factory(e,function(e,n,r){var o=h(t,r);e.grab(o,function(e){n.resolve(e)})})},d.grabAll=function(e){return d.factory(e,function(e,t,n){e.grabAll(function(e){t.resolve(e)})})},d.create=function(e,t,n){return d.factory(e,function(e,o,i){var s=h(t,i);if(n)o.resolve(new e(s));else{var c=e.create(s);c.$isSaved()?o.resolve(c):c.$once(r.Model.Events.RemoteSaves,function(){o.resolve(c)})}})},d.search=function(e,t,n,r){return d.factory(e,function(e,o,i){var s=h(t,i),c=e.search(s,n,r,!0);c.$promise.success(function(){o.resolve(c)}),c.$promise.failure(function(){o.reject()})})},d.all=function(e){return d.factory(e,function(e,t,n){e.Database.ready(function(){t.resolve(e.all())})})},d.where=function(e,t,n,r){return d.factory(e,function(e,o,i){var s=h(t,i),c=h(n,i);e.Database.ready(function(){o.resolve(e.all().filtered(s,c,r))})})},$.helper=function(e,t){var n=null;return r.get(e).success(function(e){n=e}),function(){if(!n)throw e+" Rekord failed to load or does not exist.";return t(n)}},$.search=function(e,t,n,r,o,i){return $.helper(e,function(e){return i?e.searchPaged(t,n,r,o):e.search(t,n,r,o)})},$.lazyLoad=function(e,t,n){var r={};return $.helper(e,function(o){return o.Database.remoteLoaded||e in r||(r[e]=!0,o.Database.refresh(t,n)),o})},$.filtered=function(e,t,n,r){return $.helper(e,function(e){return e.filtered(t,n,r)})},$.all=function(e){return $.helper(e,function(e){return e.all()})},$.fetchAll=function(e,t,n){return $.helper(e,function(e){return e.fetchAll(t,n)})},$.grabAll=function(e,t,n){return $.helper(e,function(e){return e.grabAll(t,n)})},e.run(["$http",i]).filter("models",v),r.Bind=s,r.Resolve=d,r.Select=c,r.Factory=$,r.Debugs.ScopeDigest=1e5}(angular.module("rekord",[]),this,angular,Rekord);
//# sourceMappingURL=rekord-angular.min.js.map
