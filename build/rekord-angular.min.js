!function(e,t,n,r,o){function i(e){return"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}function s(e){function n(n,r,o,i,s,c){if(t.debug(t.Debugs.REST,this,n,o,r),t.forceOffline)s(c,0);else{var u=function(e){i(e.data)},a=function(e){s(e.data,e.status)},f={method:n,data:r,url:o};e(f).then(u,a)}}function r(e){return{all:function(t,r){n("GET",o,e.api,t,r,[])},get:function(t,r,s){n("GET",o,i(e.api+t.$key()),r,s)},create:function(t,r,o,s){n("POST",r,i(e.api),o,s,{})},update:function(t,r,o,s){n("PUT",r,i(e.api+t.$key()),o,s,{})},remove:function(t,r,s){n("DELETE",o,i(e.api+t.$key()),r,s,{})},query:function(e,t,r,o){var i=t?"POST":"GET";n(i,t,e,r,o)}}}t.setRest(r),t.listenToNetworkStatus()}function c(e,t,n){return this instanceof c?(this.scope=e,this.target=t,this.callback=n,void this.on()):new c(e,t,n)}function u(e,n,r){this.$onRemove=t.bind(this,this.$handleRemove),this.$onRemoves=t.bind(this,this.$handleRemoves),this.$onCleared=t.bind(this,this.$handleCleared),this.$onReset=t.bind(this,this.$handleReset),this.$reset(e),this.$select(n,r)}function a(e){if(e in a.tested)return a.tested[e];try{n.module(e),a.tested[e]=!0}catch(t){a.tested[e]=!1}return a.tested[e]}function f(){return f.cached?f.cached:f.cached=a("ui.router")?"$stateParams":a("ngRoute")?"$route":!1}function l(){return a("ui.router")?function(e){return e}:a("ngRoute")?function(e){return e.current}:function(){return!1}}function h(e){return function(n){return t.isString(n)&&e?t.format(n,e):n}}function v(e,n){if(t.isObject(e)){var r={};for(var o in e)r[o]=n(e[o]);return r}return n(e)}function d(){return function(e){if(!e||!e.toArray)return e;for(var t=e.toArray(),n={},r=0;r<t.length;r++){var o=t[r];!o.$key||o.$key()in n?t.splice(r--,1):n[o.$key()]=o}return t}}var $={},g={};n.isArray=function(e){return e instanceof Array},c.prototype={on:function(){var e=this.target;t.isRekord(e)&&(e=this.target=e.Database),this.off=e[e.$change?"$change":"change"](this.notify,this),this.scope.$on("$destroy",this.off)},notify:function(){var e=this.scope;e.$$phase||(e.$digest(),this.callback&&this.callback.apply(this.target),t.debug(t.Debugs.ScopeDigest,this,e))}},u.prototype={$reset:function(e){this.$source!==e&&(this.$source&&this.$disconnect(),this.$source=e,this.$connect())},$connect:function(){this.$source.on(t.Collection.Events.Remove,this.$onRemove),this.$source.on(t.Collection.Events.Removes,this.$onRemoves),this.$source.on(t.Collection.Events.Cleared,this.$onCleared),this.$source.on(t.Collection.Events.Reset,this.$onReset)},$disconnect:function(){this.$source.off(t.Collection.Events.Remove,this.$onRemove),this.$source.off(t.Collection.Events.Removes,this.$onRemoves),this.$source.off(t.Collection.Events.Cleared,this.$onCleared),this.$source.off(t.Collection.Events.Reset,this.$onReset)},$select:function(e,n){if(t.isArray(e)){var r=this.$source.database,o={};for(var i in this)t.isBoolean(this[i])&&(o[i]=this[i]);for(var s=0;s<e.length;s++){var i=r.buildKeyFromInput(e[s]);this[i]=!0,delete o[i]}for(var i in o)delete this[i];if(n)for(var c=this.$source.keys(),s=0;s<c.length;s++){var i=c[s];this[i]||(this[i]=!1)}}},$selection:function(e){var t=this.$source,n=e||[];for(var r in this)if(this[r]===!0){var o=t.get(r);o&&n.push(o)}return n},$handleRemove:function(e){var t=this.$source.database,n=t.buildKeyFromInput(e);delete this[n]},$handleRemoves:function(e){for(var t=0;t<e.length;t++)this.$handleRemove(e[t])},$handleCleared:function(){for(var e in this)t.isBoolean(this[e])&&delete this[e]},$handleReset:function(){var e=this.$source;for(var n in this)t.isBoolean(this[n])&&(e.has(n)||delete this[n])}},t.ModelCollection.prototype.selectable=function(e,t){return new u(this,e,t)},a.tested={},f.cached=null,$.factory=function(e,n){function r(r,o){var u=r.defer();if(void 0!==c)u.resolve(c);else{var a=i(o),f=h(a);s&&u.promise.then(function(e){c=e}),t.get(e).success(function(e){n(e,u,f)})}return u.promise}var o=f(),i=l(),s=!1,c=void 0;return r.$inject=["$q"],o&&r.$inject.push(o),r.cache=function(){return s=!0,r},r.inject=function(){for(var e=0;e<arguments.length;e++){var n=arguments[e];t.isArray(n)?r.$inject.push.apply(r.$inject,n):r.$inject.push(n)}return r},r},$.model=function(e,t){return $.factory(e,function(e,n,r){var o=v(t,r);e.Database.grabModel(o,function(e){e?n.resolve(e):n.reject()})})},$.fetch=function(e,t){return $.factory(e,function(e,n,r){var o=v(t,r);e.fetch(o,function(e){n.resolve(e)})})},$.fetchAll=function(e){return $.factory(e,function(e,t,n){e.fetchAll(function(e){t.resolve(e)})})},$.grab=function(e,t){return $.factory(e,function(e,n,r){var o=v(t,r);e.grab(o,function(e){n.resolve(e)})})},$.grabAll=function(e){return $.factory(e,function(e,t,n){e.grabAll(function(e){t.resolve(e)})})},$.create=function(e,n,r){return $.factory(e,function(e,o,i){var s=v(n,i);if(r)o.resolve(new e(s));else{var c=e.create(s);c.$isSaved()?o.resolve(c):c.$once(t.Model.Events.RemoteSaves,function(){o.resolve(c)})}})},$.search=function(e,t,n,r){return $.factory(e,function(e,o,i){var s=v(t,i),c=e.search(s,n,r,!0);c.$promise.success(function(){o.resolve(c)}),c.$promise.failure(function(){o.reject()})})},$.all=function(e){return $.factory(e,function(e,t,n){e.Database.ready(function(){t.resolve(e.all())})})},$.where=function(e,t,n,r){return $.factory(e,function(e,o,i){var s=v(t,i),c=v(n,i);e.Database.ready(function(){o.resolve(e.all().filtered(s,c,r))})})},g.helper=function(e,n){var r=null;return t.get(e).success(function(e){r=e}),function(){if(!r)throw e+" Rekord failed to load or does not exist.";return n(r)}},g.search=function(e,t,n,r,o,i){return g.helper(e,function(e){return i?e.searchPaged(t,n,r,o):e.search(t,n,r,o)})},g.lazyLoad=function(e,t,n){var r={};return g.helper(e,function(o){return o.Database.remoteLoaded||e in r||(r[e]=!0,o.Database.refresh(t,n)),o})},g.filtered=function(e,t,n,r){return g.helper(e,function(e){return e.filtered(t,n,r)})},g.all=function(e){return g.helper(e,function(e){return e.all()})},g.fetchAll=function(e,t,n){return g.helper(e,function(e){return e.fetchAll(t,n)})},g.grabAll=function(e,t,n){return g.helper(e,function(e){return e.grabAll(t,n)})},r.run(["$http",s]).filter("models",d),t.Bind=c,t.Resolve=$,t.Select=u,t.Factory=g,t.Debugs.ScopeDigest=1e5}(this,this.Rekord,this.angular,this.angular.module("rekord",[]));
//# sourceMappingURL=rekord-angular.min.js.map
