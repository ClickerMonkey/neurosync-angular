!function(e,t,n,r,i){function o(e,n){function r(e){this.database=e}function o(e){return e.api?new r(e):E.call(this,e)}function s(t,n,r){e(t).then(n,r)}function a(e,t){return n("date")(e,t)}r.prototype={removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e},all:function(e,t){this.execute("GET",null,i,this.database.api,e,t,[])},get:function(e,t,n){this.execute("GET",e,i,this.removeTrailingSlash(this.database.api+e.$key()),t,n)},create:function(e,t,n,r){this.execute("POST",e,t,this.removeTrailingSlash(this.database.api),n,r,{})},update:function(e,t,n,r){this.execute("PUT",e,t,this.removeTrailingSlash(this.database.api+e.$key()),n,r,{})},remove:function(e,t,n){this.execute("DELETE",e,i,this.removeTrailingSlash(this.database.api+e.$key()),t,n,{})},query:function(e,t,n,r){var i=b(t)?"GET":"POST";this.execute(i,null,t,e,n,r)},execute:function(e,n,r,i,o,s,a){if(t.debug(t.Debugs.REST,this,e,i,r),t.forceOffline)s(a,0);else{var c=function(e){o(e.data)},u=function(e){s(e.data,e.status)},l=C(t.Angular.options,{method:e,data:r,url:i});t.Angular.adjustOptions(l,this.database,e,n,r,i,o,s),t.Angular.ajax(l,c,u)}}},t.setRest(o),t.listenToNetworkStatus(),t.formatDate=a,t.Angular={rest:o,options:{},adjustOptions:k,ajax:s,RestClass:r}}function s(e,t,n){return this instanceof s?(this.scope=e,this.target=t,this.callback=n,void this.on()):new s(e,t,n)}function a(e,t,n){this.$onRemove=A(this,this.$handleRemove),this.$onRemoves=A(this,this.$handleRemoves),this.$onCleared=A(this,this.$handleCleared),this.$onReset=A(this,this.$handleReset),this.$reset(e),this.$select(t,n)}function c(e){if(e in c.tested)return c.tested[e];try{n.module(e),c.tested[e]=!0}catch(t){c.tested[e]=!1}return c.tested[e]}function u(){return u.cached?u.cached:u.cached=c("ui.router")?"$stateParams":c("ngRoute")?"$route":!1}function l(){return c("ui.router")?function(e){return e}:c("ngRoute")?function(e){return e.current}:function(){return!1}}function f(e){return function(t){return $(t)&&e?R(t,e):t}}function h(e,t){if(g(e)){var n={};for(var r in e)n[r]=t(e[r]);return n}return t(e)}function d(){return function(e){if(!e||!e.toArray)return e;for(var t=e.toArray(),n={},r=0;r<t.length;r++){var i=t[r];!i.$key||i.$key()in n?t.splice(r--,1):n[i.$key()]=i}return t}}var v=t.isFunction,$=t.isString,p=t.isArray,g=t.isObject,y=t.isBoolean,m=t.isRekord,b=t.isEmpty,R=t.format,A=t.bind,k=t.noop,C=t.transfer,E=t.rest,S={},T={};n.isArray=function(e){return e instanceof Array},s.prototype={on:function(){var e=this.target;m(e)&&(e=this.target=e.Database);var t=e.$change?"$change":"change";e[t]&&(this.off=e[t](this.notify,this),this.scope.$on("$destroy",this.off))},notify:function(){this.scope.$evalAsync(),v(this.callback)&&this.callback.apply(this.target),t.debug(t.Debugs.ScopeDigest,this,this.scope)}},a.prototype={$reset:function(e){this.$source!==e&&(this.$source&&this.$disconnect(),this.$source=e,this.$connect())},$connect:function(){this.$source.on(t.Collection.Events.Remove,this.$onRemove),this.$source.on(t.Collection.Events.Removes,this.$onRemoves),this.$source.on(t.Collection.Events.Cleared,this.$onCleared),this.$source.on(t.Collection.Events.Reset,this.$onReset)},$disconnect:function(){this.$source.off(t.Collection.Events.Remove,this.$onRemove),this.$source.off(t.Collection.Events.Removes,this.$onRemoves),this.$source.off(t.Collection.Events.Cleared,this.$onCleared),this.$source.off(t.Collection.Events.Reset,this.$onReset)},$select:function(e,t){if(p(e)){var n=this.$source.database,r={};for(var i in this)y(this[i])&&(r[i]=this[i]);for(var o=0;o<e.length;o++){var i=n.keyHandler.buildKeyFromInput(e[o]);this[i]=!0,delete r[i]}for(var i in r)delete this[i];if(t)for(var s=this.$source.keys(),o=0;o<s.length;o++){var i=s[o];this[i]||(this[i]=!1)}}},$selection:function(e){var t=this.$source,n=e||[];for(var r in this)if(this[r]===!0){var i=t.get(r);i&&n.push(i)}return n},$handleRemove:function(e){var t=this.$source.database,n=t.keyHandler.buildKeyFromInput(e);delete this[n]},$handleRemoves:function(e){for(var t=0;t<e.length;t++)this.$handleRemove(e[t])},$handleCleared:function(){for(var e in this)y(this[e])&&delete this[e]},$handleReset:function(){var e=this.$source;for(var t in this)y(this[t])&&(e.has(t)||delete this[t])}},t.ModelCollection.prototype.selectable=function(e,t){return new a(this,e,t)},c.tested={},u.cached=null,S.factory=function(e,n){function r(r,i){var c=r.defer();if(void 0!==a)c.resolve(a);else{var u=o(i),l=f(u);s&&c.promise.then(function(e){a=e}),t.get(e).success(function(e){n(e,c,l)})}return c.promise}var i=u(),o=l(),s=!1,a=void 0;return r.$inject=["$q"],i&&r.$inject.push(i),r.cache=function(){return s=!0,r},r.inject=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];p(t)?r.$inject.push.apply(r.$inject,t):r.$inject.push(t)}return r},r},S.model=function(e,t){return S.factory(e,function(e,n,r){var i=h(t,r);e.Database.grabModel(i,function(e){e?n.resolve(e):n.reject()})})},S.fetch=function(e,t){return S.factory(e,function(e,n,r){var i=h(t,r);e.fetch(i,function(e){n.resolve(e)})})},S.fetchAll=function(e){return S.factory(e,function(e,t,n){e.fetchAll(function(e){t.resolve(e)})})},S.grab=function(e,t){return S.factory(e,function(e,n,r){var i=h(t,r);e.grab(i,function(e){n.resolve(e)})})},S.grabAll=function(e){return S.factory(e,function(e,t,n){e.grabAll(function(e){t.resolve(e)})})},S.create=function(e,n,r){return S.factory(e,function(e,i,o){var s=h(n,o);if(r)i.resolve(new e(s));else{var a=e.create(s);a.$isSaved()?i.resolve(a):a.$once(t.Model.Events.RemoteSaves,function(){i.resolve(a)})}})},S.search=function(e,t,n,r){return S.factory(e,function(e,i,o){var s=h(t,o),a=e.search(s,n,r,!0);a.$promise.success(function(){i.resolve(a)}),a.$promise.failure(function(){i.reject()})})},S.all=function(e){return S.factory(e,function(e,t,n){e.Database.ready(function(){t.resolve(e.all())})})},S.where=function(e,t,n,r){return S.factory(e,function(e,i,o){var s=h(t,o),a=h(n,o);e.Database.ready(function(){i.resolve(e.all().filtered(s,a,r))})})},T.helper=function(e,n){var r=null;return t.get(e).success(function(e){r=e}),function(){if(!r)throw e+" Rekord failed to load or does not exist.";return n(r)}},T.search=function(e,t,n,r,i,o){return T.helper(e,function(e){return o?e.searchPaged(t,n,r,i):e.search(t,n,r,i)})},T.ref=function(e,t,n){return T.helper(e,function(e){return e})},T.lazyLoad=function(e,t,n){var r={};return T.helper(e,function(i){return i.Database.remoteLoaded||e in r||(r[e]=!0,i.Database.refresh(t,n)),i})},T.filtered=function(e,t,n,r){return T.helper(e,function(e){return e.filtered(t,n,r)})},T.all=function(e){return T.helper(e,function(e){return e.all()})},T.fetchAll=function(e,t,n){return T.helper(e,function(e){return e.fetchAll(t,n)})},T.grabAll=function(e,t,n){return T.helper(e,function(e){return e.grabAll(t,n)})},r.run(["$http","$filter",o]).filter("models",d),t.Bind=s,t.Sync=s,t.Resolve=S,t.Select=a,t.Factory=T,t.Debugs.ScopeDigest=1e5}(this,this.Rekord,this.angular,this.angular.module("rekord",[]));
//# sourceMappingURL=rekord-angular.min.js.map
