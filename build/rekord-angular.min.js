!function(e,t,n,r,o){function i(e){return"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}function s(e,n){function r(n,r,o,i,s,c){if(t.debug(t.Debugs.REST,this,n,o,r),t.forceOffline)s(c,0);else{var u=function(e){i(e.data)},a=function(e){s(e.data,e.status)},f={method:n,data:r,url:o};e(f).then(u,a)}}function s(e){return{all:function(t,n){r("GET",o,e.api,t,n,[])},get:function(t,n,s){r("GET",o,i(e.api+t.$key()),n,s)},create:function(t,n,o,s){r("POST",n,i(e.api),o,s,{})},update:function(t,n,o,s){r("PUT",n,i(e.api+t.$key()),o,s,{})},remove:function(t,n,s){r("DELETE",o,i(e.api+t.$key()),n,s,{})},query:function(e,t,n,o){var i=b(t)?"GET":"POST";r(i,t,e,n,o)}}}function c(e,t){return n("date")(e,t)}t.setRest(s),t.listenToNetworkStatus(),t.formatDate=c}function c(e,t,n){return this instanceof c?(this.scope=e,this.target=t,this.callback=n,void this.on()):new c(e,t,n)}function u(e,t,n){this.$onRemove=C(this,this.$handleRemove),this.$onRemoves=C(this,this.$handleRemoves),this.$onCleared=C(this,this.$handleCleared),this.$onReset=C(this,this.$handleReset),this.$reset(e),this.$select(t,n)}function a(e){if(e in a.tested)return a.tested[e];try{n.module(e),a.tested[e]=!0}catch(t){a.tested[e]=!1}return a.tested[e]}function f(){return f.cached?f.cached:f.cached=a("ui.router")?"$stateParams":a("ngRoute")?"$route":!1}function l(){return a("ui.router")?function(e){return e}:a("ngRoute")?function(e){return e.current}:function(){return!1}}function h(e){return function(t){return p(t)&&e?E(t,e):t}}function v(e,t){if(y(e)){var n={};for(var r in e)n[r]=t(e[r]);return n}return t(e)}function d(){return function(e){if(!e||!e.toArray)return e;for(var t=e.toArray(),n={},r=0;r<t.length;r++){var o=t[r];!o.$key||o.$key()in n?t.splice(r--,1):n[o.$key()]=o}return t}}var $=t.isFunction,p=t.isString,g=t.isArray,y=t.isObject,m=t.isBoolean,R=t.isRekord,b=t.isEmpty,E=t.format,C=t.bind,k={},A={};n.isArray=function(e){return e instanceof Array},c.prototype={on:function(){var e=this.target;R(e)&&(e=this.target=e.Database);var t=e.$change?"$change":"change";e[t]&&(this.off=e[t](this.notify,this),this.scope.$on("$destroy",this.off))},notify:function(){this.scope.$evalAsync(),$(this.callback)&&this.callback.apply(this.target),t.debug(t.Debugs.ScopeDigest,this,this.scope)}},u.prototype={$reset:function(e){this.$source!==e&&(this.$source&&this.$disconnect(),this.$source=e,this.$connect())},$connect:function(){this.$source.on(t.Collection.Events.Remove,this.$onRemove),this.$source.on(t.Collection.Events.Removes,this.$onRemoves),this.$source.on(t.Collection.Events.Cleared,this.$onCleared),this.$source.on(t.Collection.Events.Reset,this.$onReset)},$disconnect:function(){this.$source.off(t.Collection.Events.Remove,this.$onRemove),this.$source.off(t.Collection.Events.Removes,this.$onRemoves),this.$source.off(t.Collection.Events.Cleared,this.$onCleared),this.$source.off(t.Collection.Events.Reset,this.$onReset)},$select:function(e,t){if(g(e)){var n=this.$source.database,r={};for(var o in this)m(this[o])&&(r[o]=this[o]);for(var i=0;i<e.length;i++){var o=n.buildKeyFromInput(e[i]);this[o]=!0,delete r[o]}for(var o in r)delete this[o];if(t)for(var s=this.$source.keys(),i=0;i<s.length;i++){var o=s[i];this[o]||(this[o]=!1)}}},$selection:function(e){var t=this.$source,n=e||[];for(var r in this)if(this[r]===!0){var o=t.get(r);o&&n.push(o)}return n},$handleRemove:function(e){var t=this.$source.database,n=t.buildKeyFromInput(e);delete this[n]},$handleRemoves:function(e){for(var t=0;t<e.length;t++)this.$handleRemove(e[t])},$handleCleared:function(){for(var e in this)m(this[e])&&delete this[e]},$handleReset:function(){var e=this.$source;for(var t in this)m(this[t])&&(e.has(t)||delete this[t])}},t.ModelCollection.prototype.selectable=function(e,t){return new u(this,e,t)},a.tested={},f.cached=null,k.factory=function(e,n){function r(r,o){var u=r.defer();if(void 0!==c)u.resolve(c);else{var a=i(o),f=h(a);s&&u.promise.then(function(e){c=e}),t.get(e).success(function(e){n(e,u,f)})}return u.promise}var o=f(),i=l(),s=!1,c=void 0;return r.$inject=["$q"],o&&r.$inject.push(o),r.cache=function(){return s=!0,r},r.inject=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];g(t)?r.$inject.push.apply(r.$inject,t):r.$inject.push(t)}return r},r},k.model=function(e,t){return k.factory(e,function(e,n,r){var o=v(t,r);e.Database.grabModel(o,function(e){e?n.resolve(e):n.reject()})})},k.fetch=function(e,t){return k.factory(e,function(e,n,r){var o=v(t,r);e.fetch(o,function(e){n.resolve(e)})})},k.fetchAll=function(e){return k.factory(e,function(e,t,n){e.fetchAll(function(e){t.resolve(e)})})},k.grab=function(e,t){return k.factory(e,function(e,n,r){var o=v(t,r);e.grab(o,function(e){n.resolve(e)})})},k.grabAll=function(e){return k.factory(e,function(e,t,n){e.grabAll(function(e){t.resolve(e)})})},k.create=function(e,n,r){return k.factory(e,function(e,o,i){var s=v(n,i);if(r)o.resolve(new e(s));else{var c=e.create(s);c.$isSaved()?o.resolve(c):c.$once(t.Model.Events.RemoteSaves,function(){o.resolve(c)})}})},k.search=function(e,t,n,r){return k.factory(e,function(e,o,i){var s=v(t,i),c=e.search(s,n,r,!0);c.$promise.success(function(){o.resolve(c)}),c.$promise.failure(function(){o.reject()})})},k.all=function(e){return k.factory(e,function(e,t,n){e.Database.ready(function(){t.resolve(e.all())})})},k.where=function(e,t,n,r){return k.factory(e,function(e,o,i){var s=v(t,i),c=v(n,i);e.Database.ready(function(){o.resolve(e.all().filtered(s,c,r))})})},A.helper=function(e,n){var r=null;return t.get(e).success(function(e){r=e}),function(){if(!r)throw e+" Rekord failed to load or does not exist.";return n(r)}},A.search=function(e,t,n,r,o,i){return A.helper(e,function(e){return i?e.searchPaged(t,n,r,o):e.search(t,n,r,o)})},A.ref=function(e,t,n){return A.helper(e,function(e){return e})},A.lazyLoad=function(e,t,n){var r={};return A.helper(e,function(o){return o.Database.remoteLoaded||e in r||(r[e]=!0,o.Database.refresh(t,n)),o})},A.filtered=function(e,t,n,r){return A.helper(e,function(e){return e.filtered(t,n,r)})},A.all=function(e){return A.helper(e,function(e){return e.all()})},A.fetchAll=function(e,t,n){return A.helper(e,function(e){return e.fetchAll(t,n)})},A.grabAll=function(e,t,n){return A.helper(e,function(e){return e.grabAll(t,n)})},r.run(["$http","$filter",s]).filter("models",d),t.Bind=c,t.Sync=c,t.Resolve=k,t.Select=u,t.Factory=A,t.Debugs.ScopeDigest=1e5}(this,this.Rekord,this.angular,this.angular.module("rekord",[]));
//# sourceMappingURL=rekord-angular.min.js.map
